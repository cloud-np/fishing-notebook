---
import PageLayout from "@layouts/PageLayout.astro";
import "../styles/index.css";
import SignUp from "@components/common/SignUp.astro";
import LoginForm from "@components/common/LoginForm.astro";

const seo = {
	title: "Fishing Notebook - Το Ημερολόγιο του Ψαρά",
	description: "Καταγράψτε τις ψαρευτικές σας εμπειρίες",
	keywords: "fishing, ψάρεμα, fishing journal",
};
---

<PageLayout seo={seo}>
	<section class="flex min-h-screen items-center justify-center bg-gradient-to-br px-4 py-12">
		<div class="w-full max-w-md">
			<!-- Logo/Brand -->
			<div class="mb-8 text-center">
				<h1 class="mb-2 text-4xl font-bold text-white">🎣 Fishing Notebook</h1>
				<p class="text-gray-300">Το Ημερολόγιο του Ψαρά</p>
			</div>

			<!-- Auth Card -->
			<div class="overflow-hidden rounded-2xl bg-slate-800 shadow-xl">
				<!-- Tabs -->
				<div class="flex border-b border-gray-700">
					<button
						id="tab-signin"
						class="flex-1 cursor-pointer border-b-2 border-blue-500 py-4 text-center font-semibold text-blue-400 transition-colors"
						data-tab="signin">
						<!-- Σύνδεση -->
						Login
					</button>
					<button
						id="tab-signup"
						class="flex-1 cursor-pointer border-b-2 border-transparent py-4 text-center font-semibold text-gray-400 transition-colors hover:text-gray-300"
						data-tab="signup">
						<!-- Εγγραφή -->
						Signup
					</button>
				</div>

				<!-- Tab Content -->
				<div class="p-8">
					<LoginForm />

					<!-- Sign Up Form -->
					<SignUp />
				</div>

				<!-- Social Login -->
				<div class="mt-4">
					<button
						id="github-login"
						class="w-full cursor-pointer rounded-lg bg-gray-800 py-3 font-semibold text-white transition-colors hover:bg-gray-900">
						Login with GitHub
					</button>
				</div>
			</div>

			<!-- Footer -->
			<p class="mt-6 text-center text-sm text-gray-400">
				Καταγράψτε κάθε ψάρεμα, ανακαλύψτε νέα σημεία, βελτιώστε την τεχνική σας
			</p>
		</div>
	</section>
</PageLayout>

<script>
	// Tab switching
	const tabSignin = document.getElementById("tab-signin") as HTMLButtonElement;
	const tabSignup = document.getElementById("tab-signup") as HTMLButtonElement;
	tabSignin.addEventListener("click", () => switchTab("signin"));
	tabSignup.addEventListener("click", () => switchTab("signup"));

	const signinForm = document.getElementById("signin-form") as HTMLFormElement;
	const signupForm = document.getElementById("signup-form") as HTMLFormElement;
	const errorMessage = document.getElementById("error-message") as HTMLDivElement;
	const successMessage = document.getElementById("success-message") as HTMLDivElement;

	function switchTab(tab: "signin" | "signup") {
		// Hide messages
		errorMessage.classList.add("hidden");
		successMessage.classList.add("hidden");

		if (tab === "signin") {
			tabSignin.classList.add("border-blue-500", "text-blue-400");
			tabSignin.classList.remove("border-transparent", "text-gray-400");
			tabSignup.classList.remove("border-blue-500", "text-blue-400");
			tabSignup.classList.add("border-transparent", "text-gray-400");
			signinForm.classList.remove("hidden");
			signupForm.classList.add("hidden");
		} else {
			tabSignup.classList.add("border-blue-500", "text-blue-400");
			tabSignup.classList.remove("border-transparent", "text-gray-400");
			tabSignin.classList.remove("border-blue-500", "text-blue-400");
			tabSignin.classList.add("border-transparent", "text-gray-400");
			signupForm.classList.remove("hidden");
			signinForm.classList.add("hidden");
		}
	}

	const { signIn } = await import("../client-libs/auth");
	// GitHub login
	const githubLoginBtn = document.getElementById("github-login") as HTMLButtonElement;
	githubLoginBtn.addEventListener("click", async () => {
		await signIn.social({
			provider: "github",
			callbackURL: "/dashboard",
		});
	});
</script>
